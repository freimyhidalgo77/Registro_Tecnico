@page "/Tecnicos/Index"
@rendermode InteractiveServer
@inject TecnicoService tecnicoService
@inject NavigationManager navigation

<PageTitle>Tecnicos</PageTitle>
<div class = "container">
	<div class ="card-header bg-primary text-white">
		<h3 class="T&eacute;cnicos"><strong>Registro de T&eacute;cnicos</strong></h3>
	</div>
	<div class="row text-right">
		<div class="col-md-3">
			<label for="filtro" class="from label"><strong>Filtrar por:</strong></label>
			<InputSelect id="filtro" class="form-select" @bind-Value="filtro">
				<option value="id">ID</option>
				<option value="Nombre">NombreTecnico</option>
				<option value="SueldoHora">SueldoHora</option>
			</InputSelect> 
	    </div>
		<div class="col-md-6">
			<label for="valorFiltro" class="form-label"><strong>B&uacute;squeda</strong></label>
			<div class="input-group">
				<InputText id="valorFiltro" @bind-Value="valorFiltro" class="form-control" placeholder="Buscar" />
				<button @onclick="Buscar" class="btn btn-danger bi bi-search" type="button"> Buscar</button>
			</div>
		</div>
		<div class="text-left">
			<a href="/Tecnicos/Create" class="btn btn-danger bi bi-plus-square-fill"> Crear</a>
		</div>
	</div>

	@*Tabla*@
	<div class="card-body">
		<table class="table table-light">
			<thead class="table table-striped text-center table-bordered mt-3 bg-primary text-white">
				<tr>
					<th>ID</th>
					<th>Nombre T&eacute;cnico</th>
					<th>Sueldo T&eacute;cnico</th>
					<th>Ver</th>
					<th>Editar</th>
					<th>Eliminar</th>
				</tr>
			</thead>
			<tbody>
				@*Buscar detalles de tecicos(Id,Nombre,Sueldo)*@
				@foreach (var tecnico in tecnicos)
				{
					<tr>
						<td class="text-center">@tecnico.TecnicoId</td>
						<td class="text-center">@tecnico.NombreTecnico</td>
						<td class="text-center">@tecnico.SueldoHora</td>

						@*Iconos*@
						<td class="text-center">
							<a href="/Tecnicos/Details/@tecnico.TecnicoId" class="btn btn-info text-white bi bi-eye"></a>
						</td>
						<td class="text-center">
							<a href="/Tecnicos/Edit/@tecnico.TecnicoId" class="btn btn-warning text-white bi bi-pencil-square"></a>
						</td>
						<td class="text-center">
							<a href="/Tecnicos/Delete/@tecnico.TecnicoId" class="btn btn-danger bi bi-trash"></a>
						</td>
					</tr>
				}
			</tbody>
		</table>
	</div>
</div>




@code {

	public List<Tecnicos> tecnicos = new List<Tecnicos>();
	public string filtro = "id";
	public string valorFiltro = "";

	protected override async Task OnInitializedAsync()
	{
		tecnicos = await tecnicoService.Listar(a => true);
	}

	//Metodo para buscar valor mediante filtro
	public async Task Buscar()
	{
		if (!string.IsNullOrWhiteSpace(valorFiltro))
		{
			switch (filtro)
			{
				case "id":
					if(int.TryParse(valorFiltro, out int id))
					{
						tecnicos = await tecnicoService.Listar(t => t.TecnicoId == id);	
					}
					break;

				case "Nombre":
					tecnicos = await tecnicoService.Listar(t => t.NombreTecnico.ToLower().Contains(valorFiltro.ToLower()));
					break;

				case "SueldoHora":
					if(float.TryParse(valorFiltro, out float SueldoHora))
					{
						tecnicos = await tecnicoService.Listar(t => t.SueldoHora == SueldoHora);
					}
					break;
			   }
	     	 }
	        else
			{
				tecnicos = await tecnicoService.Listar(async => true);
			}

		}
	}








